\section{Зависимость от конфигурации нейронной сети}

\begin{figure}[ht]
    \centering
    \begin{subfigure}[b]{0.4\textwidth}
        \begin{tikzpicture}[scale=0.85]
            \begin{axis}[
                ymode=log,
                legend style={font=\tiny},
                xmin=0,
                xtick distance=4000,
                axis lines=left,
                grid=both
            ]            
            \addplot+[mark=*, mark size=1pt, thick, red] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_bottom_neurons_(32, 64, 32).csv};
            \addlegendentry{(32, 64, 32)}
            \addplot+[mark=*, mark size=1pt, thick, green] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_bottom_neurons_(64, 32, 64).csv};
            \addlegendentry{(64, 32, 64)}
            \addplot+[mark=*, mark size=1pt, thick, blue] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_bottom_neurons_(64, 64).csv};
            \addlegendentry{(64, 64)}
            \addplot+[mark=*, mark size=1pt, thick, orange] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_bottom_neurons_(128, 128).csv};
            \addlegendentry{(128, 128)}
        \end{axis}
        \end{tikzpicture}
        \caption{Нижняя граница}
        \label{fig:bc_bottom_neurons}
    \end{subfigure}
    \hspace{0.5cm}
    \begin{subfigure}[b]{0.4\textwidth}
        \begin{tikzpicture}[scale=0.85]
            \begin{axis}[
                ymode=log,
                legend style={font=\tiny},
                xmin=0,
                xtick distance=4000,
                axis lines=left,
                grid=both
            ]
            \addplot+[mark=*, mark size=1pt, thick, red] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_top_neurons_(32, 64, 32).csv};
            \addlegendentry{(32, 64, 32)}
            \addplot+[mark=*, mark size=1pt, thick, green] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_top_neurons_(64, 32, 64).csv};
            \addlegendentry{(64, 32, 64)}
            \addplot+[mark=*, mark size=1pt, thick, blue] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_top_neurons_(64, 64).csv};
            \addlegendentry{(64, 64)}
            \addplot+[mark=*, mark size=1pt, thick, orange] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_top_neurons_(128, 128).csv};
            \addlegendentry{(128, 128)}
        \end{axis}
        \end{tikzpicture}
        \caption{Верхняя граница}
        \label{fig:bc_top_neurons}
    \end{subfigure}
    \begin{subfigure}[b]{0.4\textwidth}
        \begin{tikzpicture}[scale=0.85]
            \begin{axis}[
                ymode=log,
                legend style={font=\tiny},
                xmin=0,
                xtick distance=4000,
                axis lines=left,
                grid=both
            ]
            \addplot+[mark=*, mark size=1pt, thick, red] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_left_neurons_(32, 64, 32).csv};
            \addlegendentry{(32, 64, 32)}
            \addplot+[mark=*, mark size=1pt, thick, green] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_left_neurons_(64, 32, 64).csv};
            \addlegendentry{(64, 32, 64)}
            \addplot+[mark=*, mark size=1pt, thick, blue] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_left_neurons_(64, 64).csv};
            \addlegendentry{(64, 64)}
            \addplot+[mark=*, mark size=1pt, thick, orange] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_left_neurons_(128, 128).csv};
            \addlegendentry{(128, 128)}
        \end{axis}
        \end{tikzpicture}
        \caption{Левая граница}
        \label{fig:bc_left_neurons}
    \end{subfigure}
    \hspace{0.5cm}
    \begin{subfigure}[b]{0.4\textwidth}
        \begin{tikzpicture}[scale=0.85]
            \begin{axis}[
                ymode=log,
                legend style={font=\tiny},
                xmin=0,
                xtick distance=4000,
                axis lines=left,
                grid=both
            ]
            \addplot+[mark=*, mark size=1pt, thick, red] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_right_neurons_(32, 64, 32).csv};
            \addlegendentry{(32, 64, 32)}
            \addplot+[mark=*, mark size=1pt, thick, green] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_right_neurons_(64, 32, 64).csv};
            \addlegendentry{(64, 32, 64)}
            \addplot+[mark=*, mark size=1pt, thick, blue] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_right_neurons_(64, 64).csv};
            \addlegendentry{(64, 64)}
            \addplot+[mark=*, mark size=1pt, thick, orange] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_right_neurons_(128, 128).csv};
            \addlegendentry{(128, 128)}
        \end{axis}
        \end{tikzpicture}
        \caption{Правая граница}
        \label{fig:bc_right_neurons}
    \end{subfigure}
    \caption{Зависимость медианы функции потерь на каждой эпохе при разной конфигурации нейронной сети}
    \label{fig:bc_loss_neurons}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[htbp]
    \centering
    \begin{subfigure}[b]{0.4\textwidth}
        \centering
        \begin{tikzpicture}[scale=0.85]
            \begin{axis}[
                ymode=log,
                ymin=1e-4, ymax=1e-2,
                legend style={font=\tiny},
                xmin=0,
                xtick distance=4000,
                axis lines=left,
                grid=both
            ]
            \addplot+[mark=*, mark size=1pt, thick, red] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/pde_momentum_x_neurons_(32, 64, 32).csv};
            \addlegendentry{(32, 64, 32)}
            \addplot+[mark=*, mark size=1pt, thick, green] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/pde_momentum_x_neurons_(64, 32, 64).csv};
            \addlegendentry{(64, 32, 64)}
            \addplot+[mark=*, mark size=1pt, thick, blue] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/pde_momentum_x_neurons_(64, 64).csv};
            \addlegendentry{(64, 64)}
            \addplot+[mark=*, mark size=1pt, thick, orange] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/pde_momentum_x_neurons_(128, 128).csv};
            \addlegendentry{(128, 128)}
        \end{axis}
        \end{tikzpicture}
        \caption{Уравнение для $u_x$}
        \label{fig:pde_ux_neurons}
    \end{subfigure}
    \hspace{0.5cm}
    \begin{subfigure}[b]{0.4\textwidth}
        \centering
        \begin{tikzpicture}[scale=0.85]
            \begin{axis}[
                ymode=log,
                ymin=1e-4, ymax=1e-2,
                legend style={font=\tiny},
                xmin=0,
                xtick distance=4000,
                axis lines=left,
                grid=both
            ]
            \addplot+[mark=*, mark size=1pt, thick, red] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/pde_momentum_y_neurons_(32, 64, 32).csv};
            \addlegendentry{(32, 64, 32)}
            \addplot+[mark=*, mark size=1pt, thick, green] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/pde_momentum_y_neurons_(64, 32, 64).csv};
            \addlegendentry{(64, 32, 64)}
            \addplot+[mark=*, mark size=1pt, thick, blue] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/pde_momentum_y_neurons_(64, 64).csv};
            \addlegendentry{(64, 64)}
            \addplot+[mark=*, mark size=1pt, thick, orange] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/pde_momentum_y_neurons_(128, 128).csv};
            \addlegendentry{(128, 128)}
        \end{axis}
        \end{tikzpicture}
        \caption{Уравнение для $u_y$}
        \label{fig:pde_uy_neurons}
    \end{subfigure}
    \begin{subfigure}[b]{0.8\textwidth}
        \centering
        \begin{tikzpicture}
            \begin{axis}[
                ymode=log,
                ymin=1e-4, ymax=1e-2,
                legend style={font=\small},
                xmin=0,
                xtick distance=1000,
                axis lines=left,
                grid=both,
                width=\textwidth
            ]
            \addplot+[mark=*, mark size=1pt, thick, red] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/pde_continuity_neurons_(32, 64, 32).csv};
            \addlegendentry{(32, 64, 32)}
            \addplot+[mark=*, mark size=1pt, thick, green] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/pde_continuity_neurons_(64, 32, 64).csv};
            \addlegendentry{(64, 32, 64)}
            \addplot+[mark=*, mark size=1pt, thick, blue] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/pde_continuity_neurons_(64, 64).csv};
            \addlegendentry{(64, 64)}
            \addplot+[mark=*, mark size=1pt, thick, orange] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/pde_continuity_neurons_(128, 128).csv};
            \addlegendentry{(128, 128)}
        \end{axis}
        \end{tikzpicture}
        \caption{Уравнение непрерывности}
        \label{fig:pde_continuity_neurons}
    \end{subfigure}
    \caption{Функция потерь для уравнений Навье-Стокса \eqref{eq:navier_stockes} при разной конфигурации нейронной сети}
    \label{fig:pde_loss_neurons}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[htbp]
    \centering
    \begin{tikzpicture}
        \begin{axis}[
            width=0.8\textwidth,
            ymode=log,
            xmin=0,
            xtick distance=1000,
            axis lines=left,
            grid=both,
        ]
            \addplot+[mark=*, mark size=1pt, thick, red] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/total_loss_neurons_(32, 64, 32).csv};
            \addlegendentry{(32, 64, 32)}
            \addplot+[mark=*, mark size=1pt, thick, green] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/total_loss_neurons_(64, 32, 64).csv};
            \addlegendentry{(64, 32, 64)}
            \addplot+[mark=*, mark size=1pt, thick, blue] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/total_loss_neurons_(64, 64).csv};
            \addlegendentry{(64, 64)}
            \addplot+[mark=*, mark size=1pt, thick, orange] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/total_loss_neurons_(128, 128).csv};
            \addlegendentry{(128, 128)}
        \end{axis}
    \end{tikzpicture}
    \caption{Итоговая функция потерь при разной конфигурации нейронной сети}
    \label{fig:total_loss_neurons}
\end{figure}