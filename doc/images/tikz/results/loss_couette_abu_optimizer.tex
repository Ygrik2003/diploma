\begin{figure}[ht]
    \centering
    \begin{subfigure}[b]{0.4\textwidth}
        \begin{tikzpicture}
            \begin{axis}[
                ymode=log,
                % xlabel={Эпоха},
                ylabel={Медиана},
                xmin=0,
                xtick distance=4000,
                axis lines=left,
                grid=both,
                title={Нижняя граница},
                width=\textwidth
            ]
            \addplot+[mark=*, mark size=1pt, thick, red] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_bottom_optimizer_1.csv};
            \addplot+[mark=*, mark size=1pt, thick, green] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_bottom_optimizer_2.csv};
            \addplot+[mark=*, mark size=1pt, thick, blue] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_bottom_optimizer_4.csv};
            \end{axis}
        \end{tikzpicture}
        \label{fig:bc_bottom}
    \end{subfigure}
    \hspace{0.5cm}
    \begin{subfigure}[b]{0.4\textwidth}
        \begin{tikzpicture}
            \begin{axis}[
                ymode=log,
                % xlabel={Эпоха},
                % ylabel={Медиана},
                xmin=0,
                xtick distance=4000,
                axis lines=left,
                grid=both,
                title={Верхняя граница},
                width=\textwidth
            ]
            \addplot+[mark=*, mark size=1pt, thick, red] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_top_optimizer_1.csv};
            \addplot+[mark=*, mark size=1pt, thick, green] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_top_optimizer_2.csv};
            \addplot+[mark=*, mark size=1pt, thick, blue] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_top_optimizer_4.csv};
            \end{axis}
        \end{tikzpicture}
        \label{fig:bc_top}
    \end{subfigure}
    \vspace{0.05cm}
    \begin{subfigure}[b]{0.4\textwidth}
        \begin{tikzpicture}
            \begin{axis}[
                ymode=log,
                xlabel={Эпоха},
                ylabel={Медиана},
                xmin=0,
                xtick distance=4000,
                axis lines=left,
                grid=both,
                title={Левая граница},
                width=\textwidth
            ]
            \addplot+[mark=*, mark size=1pt, thick, red] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_left_optimizer_1.csv};
            \addplot+[mark=*, mark size=1pt, thick, green] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_left_optimizer_2.csv};
            \addplot+[mark=*, mark size=1pt, thick, blue] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_left_optimizer_4.csv};
            \end{axis}
        \end{tikzpicture}
        \label{fig:bc_left}
    \end{subfigure}
    \hspace{0.5cm}
    \begin{subfigure}[b]{0.4\textwidth}
        \begin{tikzpicture}
            \begin{axis}[
                ymode=log,
                xlabel={Эпоха},
                % ylabel={Медиана},
                xmin=0,
                xtick distance=4000,
                axis lines=left,
                grid=both,
                title={Правая граница},
                width=\textwidth
            ]
            \addplot+[mark=*, mark size=1pt, thick, red] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_right_optimizer_1.csv};
            \addplot+[mark=*, mark size=1pt, thick, green] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_right_optimizer_2.csv};
            \addplot+[mark=*, mark size=1pt, thick, blue] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/bc_right_optimizer_4.csv};
            \end{axis}
        \end{tikzpicture}
        \label{fig:bc_right}
    \end{subfigure}
    \caption{Зависимость медианы функции потерь на каждой эпохе при разных оптимизаторах}
    \label{fig:bc_loss_optimizer}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[htbp]
    \centering
    \begin{subfigure}[b]{0.4\textwidth}
        \begin{tikzpicture}
            \begin{axis}[
                ymode=log,
                ymin=1e-5, ymax=1e-2,
                xlabel={Эпоха},
                ylabel={Медиана},
                xmin=0,
                xtick distance=4000,
                axis lines=left,
                grid=both,
                title={Уравнение для $v_x$},
                width=\textwidth
            ]
            \addplot+[mark=*, mark size=1pt, thick, red] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/pde_momentum_x_optimizer_1.csv};
            \addplot+[mark=*, mark size=1pt, thick, green] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/pde_momentum_x_optimizer_2.csv};
            \addplot+[mark=*, mark size=1pt, thick, blue] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/pde_momentum_x_optimizer_4.csv};
            \end{axis}
        \end{tikzpicture}
    \end{subfigure}
    \hspace{0.5cm}
    \begin{subfigure}[b]{0.4\textwidth}
        \begin{tikzpicture}
            \begin{axis}[
                ymode=log,
                ymin=1e-5, ymax=1e-2,
                xlabel={Эпоха},
                % ylabel={Медиана},
                xmin=0,
                xtick distance=4000,
                axis lines=left,
                grid=both,
                title={Уравнение для $v_y$},
                width=\textwidth
            ]
            \addplot+[mark=*, mark size=1pt, thick, red] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/pde_momentum_y_optimizer_1.csv};
            \addplot+[mark=*, mark size=1pt, thick, green] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/pde_momentum_y_optimizer_2.csv};
            \addplot+[mark=*, mark size=1pt, thick, blue] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/pde_momentum_y_optimizer_4.csv};
            \end{axis}
        \end{tikzpicture}
    \end{subfigure}
    \begin{subfigure}[b]{0.7\textwidth}
        \begin{tikzpicture}
            \begin{axis}[
                ymode=log,
                ymin=1e-4, ymax=1e-2,
                xlabel={Эпоха},
                ylabel={Медиана},
                xmin=0,
                xtick distance=1000,
                axis lines=left,
                grid=both,
                title={Уравнение непрерывности},
                width=\textwidth
            ]
            \addplot+[mark=*, mark size=1pt, thick, red] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/pde_continuity_optimizer_1.csv};
            % \addlegendentry{(32, 64, 32)}
            \addplot+[mark=*, mark size=1pt, thick, green] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/pde_continuity_optimizer_2.csv};
            % \addlegendentry{(64, 32, 64)}
            \addplot+[mark=*, mark size=1pt, thick, blue] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/pde_continuity_optimizer_4.csv};
            % \addlegendentry{(64, 64)}
        \end{axis}
        \end{tikzpicture}
    \end{subfigure}
    \caption{Функция потерь для уравнений Навье-Стокса \eqref{eq:navier_stockes} при разных оптимизаторах}
    \label{fig:pde_loss_optimizer}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[htbp]
    \centering
    \begin{tikzpicture}
        \begin{axis}[
            width=0.8\textwidth,
            ymode=log,
            xlabel={Эпоха},
            ylabel={Медиана},
            xmin=0,
            xtick distance=1000,
            axis lines=left,
            grid=both,
        ]
            \addplot+[mark=*, mark size=1pt, thick, red] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/total_loss_optimizer_1.csv};
            \addlegendentry{Adam}
            \addplot+[mark=*, mark size=1pt, thick, green] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/total_loss_optimizer_2.csv};
            \addlegendentry{Adagrad}
            \addplot+[mark=*, mark size=1pt, thick, blue] table[x=step, y=value, col sep=comma]{data/couette_abu/loss/total_loss_optimizer_4.csv};
            \addlegendentry{ASGD}
        \end{axis}
    \end{tikzpicture}
    \caption{Итоговая функция потерь при разных оптимизаторах}
    \label{fig:total_loss_optimizer}
\end{figure}