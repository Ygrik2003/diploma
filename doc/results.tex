\chapter{Результаты обучения физически-информированной нейронной сети}
Проводилось обучение сети на задаче "течение Куэтта" с использованием функций активации REAct.
В результате первого этапа обучения модель с предсказанным минимальным отклонением от
верного решения (рис. \ref{fig:couette_react_best}) имела следующие значения
гиперпараметров (табл. \ref{table:couette_react_best_params}).

\begin{table}[ht]
    \centering
    \caption{Значения гиперпараметров у модели с лучшим результатом}
    \begin{tabular}{ |c|c| } 
        \hline
        Функция активации & $\text{REAct}(0.8, -4, -3.2, 0.2)$ \\
        \hline
        Оптимизатор & Adagrad \\ 
        \hline
        Конфигурация сети & $64-16-32$ \\ 
        \hline
        Скорость обучения & $10^{-3}$ \\ 
        \hline
        Количество точек внутри области & $100$ \\ 
        \hline
    \end{tabular}
    \label{table:couette_react_best_params}
\end{table}

В результате анализа остальных моделей было подсчитано количество нулевых
решений, решений с максимальным отклонением до 20\%, а также больше 20\% и 50\%.
Помимо перечисленных также было несколько моделей, ушедших в процессе обучения в
NaN (рис. \ref{fig:couette_react_stat}).

\begin{figure}[ht]
    \includegraphics{data/couette_react_error_best.png}
    \caption{Результат с минимальным показателем отклонения от точного решения в процессе обучения и
    кроссвалидации модели с функцией активации REAct}
    \label{fig:couette_react_best}
\end{figure}
Также стоит отметить, что все нулевые решения соответствовали функции активации,
которая на всей области определения имеет отрицательные значения.

\begin{figure}[ht]
    \centering
    \begin{tikzpicture}
        \pgfplotstableread{
        Label   First
        NaN                     4
        Нулевое\ решение        30
        $>50\%$                 16
        $>20\%$                 94
        $<20\%$                 17
        }\datatable
        
        \begin{axis}[
            xbar stacked,
            xmin=0,
            ytick=data,
            yticklabels from table={\datatable}{Label}
            ]
            \addplot [fill=yellow] table [x=First, y expr=\coordindex] {\datatable};
        \end{axis}
    \end{tikzpicture}
    \caption{Распределение результатов кроссвалидации с функцией активации REAct}
    \label{fig:couette_react_stat}
\end{figure}

В качестве корректных параметров были отобраны те, которые соответствуют критерию
принадлежности к группе с уровнем менее 20\%. В результате, во второй этап были
включены следующие параметры:
\begin{enumerate}
    \item Конфигурации с резким переходом между слоями ($16-64-32$ и $64-16-32$) а также
    с линейным переходом ($16-32-64$ и $64-32-16$) не показали особых результатов по
    сравнению с остальными трехслойными сетями. Аналогично конфигурации
    $16-16$ и $32-32$ показали себя хуже по сравнению с $64-64$.
    \item По количеству точек внутри области значительно больше удачных
    результатов было при $100$ точек. Это поведение характеризуется 
    соотношением точек на границе и внутри области. Данное соотношение 
    показывает значимость граничных условий, что необходимо для избегания
    нулевого решения
    \item Скорость обучения влияет на то, сможет ли оптимизатор 
    выбраться из локального минимума. Лучший результат показало значение
    скорости обучения равное $10^{-3}$
    \item Среди оптимизаторов лучшие результаты показали \textbf{Adam}, \textbf{Adagrad} и
    \textbf{ASGD}, в свою очередь \textbf{Adamax} и \textbf{RSMProp} являются узкоспециализированными,
    что требует точной настройки параметров, что в данной работе не рассматривается.
\end{enumerate} 

Теперь получив более точное представление о наших параметрах можно приступить
ко второму этапу.

В представленных ниже графиках показано сравнение результатов работы нейронной сети
при различных гиперпараметрах. Такой подход позволяет детально проанализировать
влияние каждого параметра на общую эффективность модели и выявить, какие параметры
обеспечивают наилучшее качество обучения.
\input{images/tikz/results/loss_couette_abu_neurons.tex}
\input{images/tikz/results/loss_couette_abu_optimizer.tex}
\input{images/tikz/results/loss_couette_abu_scale.tex}

\section{Лучший результат}
Исходя из полученых результатов можно сделать вывод, что модель со следующими
параметрами (табл. \ref{table:couette_abu_best_params}) является лучшей с точки
зрения стабильности и общей функции потерь.

\begin{table}[ht]
    \centering
    \caption{Значения гиперпараметров у модели с лучшим результатом}
    \begin{tabular}{ |c|c| } 
        \hline
        Функция активации & $\text{ABU}(0, 1, 1, 1)$ \\
        \hline
        Оптимизатор & Adam \\ 
        \hline
        Конфигурация сети & $128-128$ \\ 
        \hline
    \end{tabular}
    \label{table:couette_abu_best_params}
\end{table}

\begin{figure}[ht]
    \includegraphics{data/couette_abu_error_best.png}
    \caption{Результат с минимальным показателем отклонения от точного решения в процессе обучения и
    кроссвалидации модели с функцией активации ABU отобраный в результате анализа функции потерь}
    \label{fig:couette_abu_best}
\end{figure}

Однако как было отмечено при кроссвалидации функции потерь, имеется неоднозначность между
функцией потерь для уравнений Навье-Стокса и потерями на границах области. Хоть и были
получены результаты с низким процентом отклонения от точного решения, где максимальное
отклонение составило $2.6\%$, среди кроссвалидируемых результатов были и следующие
качественные модели (табл. \ref{table:couette_abu_best_models})

\begin{table}[ht]
    \centering
    \caption{Качественные модели при разных коэффициентах}
    \begin{tabular}{ |c|c|c|c|c|c| } 
        \hline
        Номер модели & $\beta_0$ & $\beta_1$ & $\beta_2$ & $\beta_3$ & Отклонение, \% \\
        \hline
        $1$ & $1$ & $1$ & $1$ & $0$ & $1.125$ \\ 
        \hline
        $2$ & $1$ & $1$ & $1$ & $0$ & $1.800$ \\ 
        \hline
        $3$ & $1$ & $1$ & $1$ & $0$ & $2.600$ \\ 
        \hline
        $4$ & $1$ & $1$ & $0$ & $0$ & $2.880$ \\ 
        \hline
        $5$ & $1$ & $1$ & $0$ & $0$ & $2.250$ \\ 
        \hline
        $6$ & $0$ & $1$ & $1$ & $1$ & $4.500$ \\ 
        \hline
        $7$ & $0$ & $1$ & $1$ & $1$ & $2.700$ \\ 
        \hline
    \end{tabular}
    \label{table:couette_abu_best_models}
\end{table}

Как можно заметить, некоторые модели имеют одни и те же коэффициенты, но
разные результаты. Это связано с тем, что результат модели также 
зависит от начальной инициализации весов, которая каждый раз
генерируется случайным образом.

Исходя из таблицы \ref{table:couette_abu_best_models} лучшая модель
выдала результат (рис. \ref{fig:couette_abu_best_model}) с максимальным отклонением в $1.125\%$.

\begin{figure}[ht]
    \includegraphics{data/couette_abu_error_best_model.png}
    \caption{Результат с минимальным показателем отклонения от точного решения в процессе обучения и
    кроссвалидации модели с функцией активации ABU отобраный в результате ручного анализа}
    \label{fig:couette_abu_best_model}
\end{figure}

Можно заметить, что оптимизатор и количество слоев совпало
с результатами кроссвалидации, в отличии от параметров
функции активации. Как упоминалось ранее, это связано с
малой выборкой параметров $\beta_i$, а также с присутствием
в выборке плохо обученных моделей. 

\chapter*{Заключение}
\addcontentsline{toc}{chapter}{Заключение}

В процессе анализа поведения физически-информированной нейронной сети были выявлены
закономерности и зависимости от гиперпараметров, на которые следует обращать внимание
при настройке модели для конкретной задачи.

Практическая значимость подхода заключается в уменьшении необходимости в большом объёме
экспериментальных данных, ускорении вычислений и возможности эффективного использования
современных вычислительных платформ (CPU, GPU, NPU). Это открывает перспективы для применения
PINN в таких сферах, как игровая и киноиндустрия, где требуется быстрое и реалистичное
моделирование жидкостей.

В работе проведён анализ влияния различных параметров нейронной сети (структуры, функций
активации, методов оптимизации) на качество решения. Особое внимание уделено выбору
функций активации, показано преимущество адаптивных и комбинированных функций (например,
ABU-PINN) для задач с различными физическими свойствами.

Результаты тестирования на задаче течения Куэтта с известным аналитическим решением подтвердили
способность PINN воспроизводить физически корректные распределения скоростей и давления,
а также выявили влияние архитектурных решений на точность модели.

Выбор правильного оптимизатора позволяет избегать нулевых решений, если это позволяет
функция активации. Количество точек внутри области и на ее границах, а если быть точным,
их отношение, влияет на то, какой из уравнений в постановке задачи будет отдан приоритет.
Конкретного соотношения нет, поэтому следует проводить кроссвалидацию как можно с большим
количеством вариантов. Функция активации в основном влияет на решение внутри области в
силу своей главной задачи --- внести нелинейность. 

Также были сравнены функции активации ABU и REAct, в результате которого были сделаны выводы,
что ABU пусть и медленнее, но намного точнее справляется со своей задачей.

Основные ограничения связаны с необходимостью подбора архитектуры сети под конкретную задачу
и возможной нестабильностью обучения при сложных физических условиях. Тем не менее, подход PINN
демонстрирует высокую гибкость и потенциал для дальнейшего развития.

Физически-информированные нейронные сети являются перспективным инструментом для моделирования
гидродинамических процессов, обеспечивая высокую точность и устойчивость решений при минимальных
требованиях к объёму экспериментальных данных. Дальнейшее развитие этой технологии связано с
оптимизацией архитектур, расширением области применения и интеграцией с другими методами машинного
обучения и численного моделирования.